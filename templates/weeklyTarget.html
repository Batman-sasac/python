<div class="study-setting-card">
    <h3>ğŸ“… ì›”ê°„ í•™ìŠµ ì£¼ê¸° ì„¤ì •</h3>
    <p>ì´ í€´ì¦ˆë¥¼ í•œ ë‹¬ ë™ì•ˆ ëª‡ ë²ˆ ë³µìŠµí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>

    <div class="input-group">
        <input type="number" id="reviewCount" min="1" max="30" value="7">
        <span>ë²ˆ ë³µìŠµí•˜ê¸°</span>
    </div>

    <p class="hint">* 30ì¼ ê¸°ì¤€ìœ¼ë¡œ ê· ë“±í•˜ê²Œ ë°°ì •ë©ë‹ˆë‹¤.</p>

    <button type="button" onclick="saveMonthlyPlan()" class="btn-save">ì„¤ì •</button>
</div>

<script>
    async function saveMonthlyPlan() {
        const countInput = document.getElementById('reviewCount');
        if (!countInput) return console.error("reviewCount ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

        const count = countInput.value;

        try {
            const response = await fetch("/cycle/set-goal", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    cycle_count: parseInt(count)
                })
            });

            const result = await response.json();

            if (result.status === "success") {
                console.log("ìƒì„±ëœ ë‚ ì§œë“¤:", result.scheduled_dates);

                // 2. ì•Œë¦¼ì°½ ë„ìš°ê¸° (í™•ì¸ì„ ëˆ„ë¥¼ ë•Œê¹Œì§€ ì½”ë“œê°€ ì—¬ê¸°ì„œ ëŒ€ê¸°í•¨)
                alert(`âœ… ì„¤ì • ì™„ë£Œ! í•œ ë‹¬ ë™ì•ˆ ${count}íšŒì˜ í•™ìŠµ ì¼ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);

                // 3. ë§ˆì§€ë§‰ì— í˜ì´ì§€ ì´ë™ (ê²½ë¡œê°€ ì •í™•í•œì§€ í™•ì¸ í•„ìˆ˜!)
                window.location.replace("/home");
            } else {
                alert("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + result.message);
            }
        } catch (e) {
            console.error("ì—ëŸ¬ ë°œìƒ:", e);
            alert("ì¼ì • ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
    }
</script>