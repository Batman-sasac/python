<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>GPT OCR 학습 시작</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            padding: 50px;
        }

        #result {
            margin-top: 20px;
            white-space: pre-wrap;
            text-align: left;
            display: inline-block;
            border: 1px solid #ccc;
            padding: 20px;
            width: 80%;
        }

        .loading {
            color: blue;
        }
    </style>
</head>

<body>
    <h1>GPT OCR 텍스트 추출</h1>
    <input type="file" id="fileInput" accept="image/*,application/pdf">
    <button onclick="startOCR()">스캔 시작</button>

    <div id="status"></div>
    <div id="result">결과가 여기에 표시됩니다.</div>

    <script>
        async function startOCR() {
            const fileInput = document.getElementById('fileInput');
            const resultDiv = document.getElementById('result');
            const statusDiv = document.getElementById('status');

            if (!fileInput.files[0]) {
                alert("파일을 선택해주세요!");
                return;
            }

            const formData = new FormData();
            formData.append("file", fileInput.files[0]);

            statusDiv.innerText = "분석 중... 잠시만 기다려주세요.";
            resultDiv.innerText = "";

            try {
                // FastAPI 서버의 /ocr 엔드포인트 호출
                const response = await fetch("http://127.0.0.1:8000/ocr", {
                    method: "POST",
                    body: formData
                });
                const data = await response.json();

                if (data.status === "success") {
                    resultDiv.innerText = data.text;
                    statusDiv.innerText = "분석 완료!";
                } else {
                    resultDiv.innerText = "에러: " + data.message;
                }
            } catch (error) {
                resultDiv.innerText = "서버 연결 실패: " + error;
            }
        }
    </script>
</body>

</html>